import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState, useRef, useEffect } from 'react';
import { Send, Terminal as TerminalIcon, ShieldCheck, Activity, Shield, Binary, Loader2, Sparkles, CheckCircle, Phone, Video, MoreVertical, Paperclip, Smile, Lock, X } from 'lucide-react';
const MULTIVECTOR_SYMBOLS = 'Ï†ÏˆÎ·_rRâ‚„Î¨ð”¾â‚ƒâ‚‚âˆ§âˆ¨âŠ—âˆ˜âˆ‡âˆ«âˆ‚âˆ‘âˆâˆšâˆžÎ±Î²Î³Î´ÎµÎ¶Î·Î¸Î¹ÎºÎ»Î¼Î½Î¾Î¿Ï€ÏÏ‚ÏƒÏ„Ï…Ï†Ï‡ÏˆÏ‰â„›â„³ð’¢ð’ªâˆ‡_Ï†Ï†â»Â¹Ï†Â²Ï†Â³Ï†â´âŸ¨âŸ©â€¢â‹†âºâ»â„â„‚â„â„•â„™â„šâ„â„¤â„µâ„¶â„·â„¸âˆ†âˆ‡âˆˆâˆ‹âˆŽâˆâˆâˆ‘âˆ“âˆ”âˆ•âˆ–âˆ—âˆ˜âˆ™âˆšâˆ›âˆœâˆâˆŸâˆ âˆ¡âˆ¢âˆ£âˆ¤âˆ¥âˆ¦âˆ©âˆªâˆ¬âˆ­âˆ®âˆ¯âˆ°âˆ±âˆ²âˆ³âˆ´âˆµâˆ¶âˆ·âˆ¸âˆ¹âˆºâˆ»âˆ¼âˆ½âˆ¾âˆ¿â‰€â‰â‰‚â‰ƒâ‰„â‰…â‰†â‰‡â‰ˆâ‰‰â‰Šâ‰‹â‰Œâ‰â‰Žâ‰â‰â‰‘â‰’â‰“â‰”â‰•â‰–â‰—â‰˜â‰™â‰šâ‰›â‰œâ‰â‰žâ‰Ÿâ‰ â‰¡â‰¢â‰£â‰¤â‰¥â‰¦â‰§â‰¨â‰©â‰ªâ‰«â‰¬â‰­â‰®â‰¯â‰°â‰±â‰²â‰³â‰´â‰µâ‰¶â‰·â‰¸â‰¹â‰ºâ‰»â‰¼â‰½â‰¾â‰¿âŠ€âŠâŠ‚âŠƒâŠ„âŠ…âŠ†âŠ‡âŠˆâŠ‰âŠŠâŠ‹âŠŒâŠâŠŽâŠâŠâŠ‘âŠ’âŠ“âŠ”âŠ•âŠ–âŠ—âŠ˜âŠ™âŠšâŠ›âŠœâŠâŠžâŠŸâŠ âŠ¡âŠ¢âŠ£âŠ¤âŠ¥âŠ¦âŠ§âŠ¨âŠ©âŠªâŠ«âŠ¬âŠ­âŠ®âŠ¯âŠ°âŠ±âŠ²âŠ³âŠ´âŠµâŠ¶âŠ·âŠ¸âŠ¹âŠºâŠ»âŠ¼âŠ½âŠ¾âŠ¿â‹€â‹â‹‚â‹ƒâ‹„â‹…â‹†â‹‡â‹ˆâ‹‰â‹Šâ‹‹â‹Œâ‹â‹Žâ‹â‹â‹‘â‹’â‹“â‹”â‹•â‹–â‹—â‹˜â‹™â‹šâ‹›â‹œâ‹â‹žâ‹Ÿâ‹ â‹¡â‹¢â‹£â‹¤â‹¥â‹¦â‹§â‹¨â‹©â‹ªâ‹«â‹¬â‹­â‹®â‹¯â‹°â‹±â‚€â‚â‚‚â‚ƒâ‚„â‚…â‚†â‚‡â‚ˆâ‚‰â°Â¹Â²Â³â´âµâ¶â·â¸â¹âºâ»â¼â½â¾';
const FlowerOfLifeSmall = ({ size = 24, color = "currentColor", rotor = false, pulse = false }) => (_jsxs("svg", { viewBox: "0 0 100 100", width: size, height: size, className: `opacity-100 transition-all duration-700 ${rotor ? 'animate-[rotorse-alpha_10s_linear_infinite]' : ''} ${pulse ? 'animate-pulse scale-110' : ''}`, children: [_jsx("circle", { cx: "50", cy: "50", r: "16", fill: "none", stroke: color, strokeWidth: "1" }), [0, 60, 120, 180, 240, 300].map(angle => (_jsx("circle", { cx: 50 + 16 * Math.cos(angle * Math.PI / 180), cy: 50 + 16 * Math.sin(angle * Math.PI / 180), r: "16", fill: "none", stroke: color, strokeWidth: "1" }, angle)))] }));
const DiegeticTerminal = ({ messages, onSend, onFileUpload, fileProgress = 0, isVerifying, nodeId, onCall }) => {
    const [input, setInput] = useState('');
    const [isFocused, setIsFocused] = useState(false);
    const [showPalette, setShowPalette] = useState(false);
    const [feedback, setFeedback] = useState(null);
    const scrollRef = useRef(null);
    const fileInputRef = useRef(null);
    useEffect(() => {
        if (scrollRef.current) {
            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;
        }
    }, [messages, isVerifying]);
    const handleSubmit = (e) => {
        e.preventDefault();
        if (input.trim() && !isVerifying) {
            onSend(input);
            setInput('');
            setShowPalette(false);
        }
    };
    const handleFileChange = (e) => {
        const file = e.target.files?.[0];
        if (file && onFileUpload) {
            onFileUpload(file);
            setFeedback(`ISO_FILE_QUEUED: ${file.name.toUpperCase()}`);
            setTimeout(() => setFeedback(null), 3000);
        }
        if (fileInputRef.current)
            fileInputRef.current.value = '';
    };
    const insertSymbol = (sym) => {
        setInput(prev => prev + sym);
    };
    const triggerEmotesFeedback = () => {
        setFeedback("EMOTE_ENGINE_PROVING_SOUNDNESS...");
        setTimeout(() => setFeedback(null), 3000);
    };
    const isAiThinking = isVerifying || (messages.length > 0 && !messages[messages.length - 1].isMe && messages[messages.length - 1].content === '');
    return (_jsxs("div", { className: "flex flex-col h-full bg-[#010401] font-mono text-[#00f3ff] relative overflow-hidden", children: [_jsx("input", { type: "file", ref: fileInputRef, onChange: handleFileChange, className: "hidden" }), _jsxs("div", { className: "px-4 md:px-12 py-4 md:py-6 border-b-[0.5px] border-[#4caf50]/30 bg-black/90 flex justify-between items-center text-[7px] md:text-[10px] uppercase tracking-[0.2em] md:tracking-[0.4em] relative z-20 font-black shadow-lg", children: [_jsxs("div", { className: "flex gap-4 md:gap-10 items-center", children: [_jsxs("div", { className: "flex items-center gap-2 md:gap-3", children: [_jsx(FlowerOfLifeSmall, { color: "#00f3ff", size: 18, rotor: true }), _jsx("span", { className: "text-[#00f3ff] drop-shadow-[0_0_8px_#00f3ff66] truncate max-w-[90px] sm:max-w-none opacity-80", children: "CHANNEL_ISO_CORE_0x9" })] }), _jsxs("div", { className: "hidden sm:flex items-center gap-4 opacity-30", children: [_jsx(Binary, { size: 14, strokeWidth: 1 }), _jsxs("span", { className: "hidden md:block", children: ["TUNNEL: ", nodeId] })] })] }), _jsxs("div", { className: "flex items-center gap-4 md:gap-10 text-[#00f3ff]", children: [_jsxs("div", { className: "flex gap-4", children: [_jsx("button", { onClick: () => {
                                            setFeedback("INITIATING_SECURE_VOICE...");
                                            setTimeout(() => { setFeedback(null); onCall?.('voice'); }, 1000);
                                        }, className: "cursor-pointer opacity-60 hover:opacity-100 transition-opacity active:scale-90 p-1", children: _jsx(Phone, { size: 18, strokeWidth: 1 }) }), _jsx("button", { onClick: () => {
                                            setFeedback("INITIATING_SECURE_VIDEO...");
                                            setTimeout(() => { setFeedback(null); onCall?.('video'); }, 1000);
                                        }, className: "cursor-pointer opacity-60 hover:opacity-100 transition-opacity active:scale-90 p-1", children: _jsx(Video, { size: 18, strokeWidth: 1 }) })] }), _jsx("div", { className: "w-[0.5px] h-4 bg-[#4caf50]/30" }), _jsxs("div", { className: "flex items-center gap-1.5 text-[#4caf50]", children: [_jsx("div", { className: "w-1.5 h-1.5 bg-[#4caf50] rounded-full animate-pulse opacity-60" }), _jsx("span", { className: "tracking-widest uppercase italic font-black text-[7px] hidden xs:block opacity-60", children: "SYNC" })] }), _jsx(MoreVertical, { size: 18, className: "cursor-pointer opacity-20 hover:opacity-100 p-1", strokeWidth: 1 })] })] }), _jsxs("div", { ref: scrollRef, className: "flex-1 overflow-y-auto p-4 md:p-12 lg:p-16 space-y-10 md:space-y-14 scrollbar-hide scroll-smooth relative z-10 pb-24 md:pb-16 bg-[#010401]", children: [_jsxs("div", { className: "text-[7px] md:text-[9px] text-[#4caf50]/30 uppercase mb-8 md:mb-12 pb-6 md:pb-10 border-b-[0.5px] border-[#4caf50]/20 font-black tracking-[0.2em] md:tracking-[0.4em] leading-loose italic", children: [_jsxs("p", { className: "flex items-center gap-3 md:gap-4 mb-2", children: [_jsx(Activity, { size: 10, strokeWidth: 1 }), " ISO_ESTABLISHED: ", new Date().toLocaleTimeString()] }), _jsxs("p", { className: "flex items-center gap-3 md:gap-4 mb-2", children: [_jsx(Shield, { size: 10, strokeWidth: 1 }), " ENCRYPTION: G3T_DOUBLE_RATCHET"] }), _jsxs("p", { className: "flex items-center gap-3 md:gap-4 text-[#00f3ff]/40 animate-pulse", children: [_jsx(Sparkles, { size: 10, strokeWidth: 1 }), " GEODESIC_SYNC: 0.9999812_STABLE"] })] }), messages.map((msg) => (_jsxs("div", { className: `flex flex-col ${msg.isMe ? 'items-end' : 'items-start'} animate-in fade-in slide-in-from-bottom-2 duration-500 relative group`, children: [_jsxs("div", { className: `flex items-center gap-3 md:gap-4 mb-2 md:mb-3 text-[7px] md:text-[10px] uppercase tracking-[0.2em] md:tracking-[0.3em] font-black ${msg.isMe ? 'text-[#00f3ff]/50' : 'text-[#4caf50]/50'}`, children: [!msg.isMe && _jsx(Lock, { size: 10, className: "text-[#00f3ff] opacity-60", strokeWidth: 1 }), msg.isZkpVerified && _jsx(ShieldCheck, { size: 12, className: "opacity-60", strokeWidth: 1 }), _jsx("span", { className: "opacity-60", children: msg.sender }), _jsxs("span", { className: "opacity-30 font-black font-mono", children: ["[", new Date(msg.timestamp).toLocaleTimeString([], { hour12: false, hour: '2-digit', minute: '2-digit' }), "]"] })] }), _jsxs("div", { className: `relative max-w-[95%] md:max-w-[85%] p-4 md:p-8 text-[11px] md:text-[15px] border-l-[0.5px] transition-all duration-500 shadow-lg ${msg.isMe
                                    ? 'bg-[#00f3ff]/[0.03] border-[#00f3ff]/30 text-[#00f3ff] hover:bg-[#00f3ff]/[0.05]'
                                    : 'bg-[#4caf50]/[0.03] border-[#4caf50]/30 text-[#4caf50] hover:bg-[#4caf50]/[0.05]'}`, children: [_jsx("p", { className: "leading-relaxed whitespace-pre-wrap font-bold tracking-tight opacity-90 group-hover:opacity-100 transition-opacity", children: msg.content || (_jsxs("span", { className: "flex items-center gap-6 italic opacity-30", children: [_jsx(Loader2, { size: 16, className: "animate-spin", strokeWidth: 1 }), "Calculating..."] })) }), _jsxs("div", { className: "absolute -top-3 right-4 md:right-8 flex items-center gap-2 px-3 py-0.5 bg-black border-[0.5px] border-[#00f3ff]/20 text-[6px] md:text-[8px] font-black tracking-[0.2em] md:tracking-[0.3em] text-[#00f3ff] uppercase group-hover:opacity-100 opacity-30 transition-opacity cursor-default z-20 shadow-xl", children: [_jsx(CheckCircle, { size: 8, className: "animate-pulse", strokeWidth: 1 }), _jsx("span", { children: "SOUND_VERIFIED" })] }), msg.isMe && (_jsxs("div", { className: "absolute -bottom-4 md:-bottom-5 right-0 flex items-center gap-2 md:gap-3 text-[6px] md:text-[9px] font-black italic tracking-widest opacity-20 group-hover:opacity-60 transition-opacity", children: [_jsxs("span", { className: "uppercase font-mono", children: ["PKT_", msg.id.substr(0, 4).toUpperCase()] }), _jsxs("div", { className: "flex items-center gap-1.5", children: [msg.isZkpVerified && _jsx(Shield, { size: 8, className: "text-[#00f3ff] opacity-40", strokeWidth: 1.5 }), _jsxs("div", { className: "flex gap-0.5", children: [_jsx(CheckCircle, { size: 8, className: msg.status === 'read' ? 'text-[#00f3ff]' : 'text-white/10', strokeWidth: 1 }), _jsx(CheckCircle, { size: 8, className: msg.status === 'delivered' || msg.status === 'read' ? 'text-[#00f3ff]' : 'text-white/10', strokeWidth: 1 })] })] })] }))] })] }, msg.id))), isAiThinking && (_jsxs("div", { className: "flex flex-col items-start animate-in fade-in duration-700", children: [_jsxs("div", { className: "flex items-center gap-4 mb-3 text-[7px] md:text-[11px] uppercase tracking-[0.3em] md:tracking-[0.4em] font-black text-[#4caf50]/40", children: [_jsx(FlowerOfLifeSmall, { size: 14, color: "#4caf50", rotor: true, pulse: true }), _jsx("span", { children: "G3T_ISO_ARCHITECT" })] }), _jsxs("div", { className: "p-4 md:p-10 border-l-[0.5px] border-[#4caf50]/20 bg-[#4caf50]/[0.02] text-[10px] md:text-[14px] italic opacity-30 flex items-center gap-6 md:gap-12", children: [_jsx(FlowerOfLifeSmall, { size: 28, color: "#00f3ff", pulse: true, rotor: true }), _jsx("span", { className: "font-black tracking-[0.1em] md:tracking-[0.2em] opacity-80 animate-pulse", children: "Synchronizing_Geodesic..." })] })] }))] }), showPalette && (_jsx("div", { className: "absolute bottom-24 md:bottom-28 left-4 md:left-12 right-4 md:right-12 z-[150] animate-in slide-in-from-bottom-6 duration-300", children: _jsxs("div", { className: "bg-black border-[0.5px] border-[#4caf50]/30 p-4 md:p-6 shadow-[0_-15px_60px_rgba(0,0,0,0.95)] backdrop-blur-xl", children: [_jsxs("div", { className: "flex justify-between items-center mb-4 border-b-[0.5px] border-[#4caf50]/10 pb-3", children: [_jsxs("span", { className: "text-[7px] md:text-[9px] font-black tracking-[0.3em] uppercase text-[#4caf50]/60 flex items-center gap-2", children: [_jsx(Binary, { size: 10 }), " MULTIVECTOR_ONTOLOGY_PALETTE"] }), _jsx("button", { onClick: () => setShowPalette(false), className: "text-[#4caf50] opacity-40 hover:opacity-100 p-1", children: _jsx(X, { size: 14 }) })] }), _jsx("div", { className: "grid grid-cols-6 sm:grid-cols-10 md:grid-cols-16 lg:grid-cols-20 gap-1.5 h-36 md:h-48 overflow-y-auto scrollbar-hide", children: MULTIVECTOR_SYMBOLS.split('').map((sym, idx) => (_jsx("button", { type: "button", onClick: () => insertSymbol(sym), className: "w-full aspect-square border-[0.5px] border-[#4caf50]/10 flex items-center justify-center text-[12px] md:text-[15px] text-[#00f3ff]/40 hover:text-[#00f3ff] hover:bg-[#00f3ff]/10 hover:border-[#00f3ff]/30 transition-all active:scale-90 font-bold", children: sym }, idx))) })] }) })), feedback && (_jsxs("div", { className: "absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[200] px-8 py-5 border-[0.5px] border-[#00f3ff]/60 bg-black/95 text-[#00f3ff] text-[9px] md:text-[11px] font-black tracking-[0.4em] uppercase animate-in zoom-in duration-300 shadow-[0_0_50px_#00f3ff33] backdrop-blur-xl text-center flex flex-col items-center gap-4", children: [_jsx(FlowerOfLifeSmall, { size: 24, color: "#00f3ff", rotor: true }), feedback] })), _jsxs("form", { onSubmit: handleSubmit, className: `p-4 md:p-8 lg:p-12 border-t-[0.5px] border-[#4caf50]/20 bg-black/95 flex flex-col md:flex-row items-center gap-4 md:gap-8 relative transition-all duration-700 z-50 ${isFocused ? 'bg-black shadow-[inset_0_1px_50px_rgba(0,243,255,0.05)]' : ''}`, children: [_jsx("div", { className: `absolute -top-[0.5px] left-0 h-[0.5px] bg-[#00f3ff] transition-all duration-700 opacity-60 ${isFocused ? 'w-full' : 'w-0'}` }), _jsxs("div", { className: "flex items-center justify-between md:justify-start gap-3 w-full md:w-auto", children: [_jsxs("div", { className: "flex gap-2.5", children: [_jsxs("button", { type: "button", onClick: () => fileInputRef.current?.click(), className: "p-3 border-[0.5px] border-[#4caf50]/20 text-[#4caf50] hover:text-[#00f3ff] hover:border-[#00f3ff]/40 transition-all relative overflow-hidden group active:scale-90", children: [_jsx(Paperclip, { size: 18, className: `relative z-10 transition-transform ${fileProgress > 0 ? 'scale-75 opacity-40' : 'group-hover:scale-110'}`, strokeWidth: 1 }), fileProgress > 0 && (_jsx("div", { className: "absolute inset-0 flex items-center justify-center", children: _jsx("div", { className: "w-6 h-6 border-[0.5px] border-[#00f3ff]/40 rounded-full animate-spin" }) })), fileProgress > 0 && (_jsx("div", { className: "absolute bottom-0 left-0 w-full bg-[#00f3ff]/40 transition-all duration-300", style: { height: `${fileProgress}%` } }))] }), _jsx("button", { type: "button", onClick: () => setShowPalette(!showPalette), className: `p-3 border-[0.5px] transition-all active:scale-90 ${showPalette ? 'border-[#00f3ff] text-[#00f3ff] bg-[#00f3ff]/10' : 'border-[#4caf50]/20 text-[#4caf50] hover:text-[#00f3ff] hover:border-[#00f3ff]/40'}`, children: _jsx(Binary, { size: 18, strokeWidth: 1 }) }), _jsx("button", { type: "button", onClick: triggerEmotesFeedback, className: "p-3 border-[0.5px] border-[#4caf50]/20 text-[#4caf50] hover:text-[#00f3ff] hover:border-[#00f3ff]/40 transition-all active:scale-90 opacity-50", children: _jsx(Smile, { size: 18, strokeWidth: 1 }) })] }), _jsx("div", { className: "md:hidden flex-1 px-4 flex justify-center", children: isVerifying && _jsx(Loader2, { size: 16, className: "animate-spin text-[#00f3ff]/50" }) }), _jsx("button", { type: "submit", disabled: !input.trim() || isVerifying, className: `md:hidden p-3 border-[0.5px] transition-all active:scale-90 ${!input.trim() || isVerifying ? 'opacity-20 border-[#4caf50]/10 text-[#4caf50]' : 'border-[#00f3ff]/60 text-[#00f3ff] bg-[#00f3ff]/10'}`, children: _jsx(Send, { size: 18, strokeWidth: 1 }) })] }), _jsxs("div", { className: "flex-1 flex items-center gap-3 w-full px-2 border-b-[0.5px] md:border-none border-[#4caf50]/10 md:pb-0", children: [_jsx(TerminalIcon, { size: 16, className: `hidden sm:block transition-colors duration-700 ${isFocused ? 'text-[#00f3ff]/40' : 'text-[#4caf50]/20'}`, strokeWidth: 1 }), _jsx("input", { type: "text", value: input, onFocus: () => setIsFocused(true), onBlur: () => setIsFocused(false), onChange: (e) => setInput(e.target.value), placeholder: isVerifying ? "DERIVING_PROOF..." : "Transmit ISO packet...", disabled: isVerifying, className: "flex-1 bg-transparent border-none outline-none text-[#00f3ff] placeholder-[#4caf50]/20 text-[13px] md:text-xl py-3 md:py-4 tracking-wider md:tracking-widest font-mono font-black caret-[#00f3ff] uppercase opacity-80 hover:opacity-100 transition-opacity" })] }), _jsxs("button", { type: "submit", disabled: !input.trim() || isVerifying, className: `hidden md:flex items-center justify-center gap-6 px-12 py-5 border-[0.5px] border-[#00f3ff]/40 font-black text-xs md:text-sm orbitron tracking-[0.4em] md:tracking-[0.5em] transition-all duration-700 relative overflow-hidden ${!input.trim() || isVerifying ? 'opacity-20 border-[#4caf50]/10 text-[#4caf50]' : 'text-[#00f3ff] hover:bg-[#00f3ff]/10 hover:border-[#00f3ff]/60 active:scale-95 shadow-[0_0_20px_rgba(0,243,255,0.1)]'}`, children: [_jsx("span", { className: "relative z-10 uppercase", children: "TRANSMIT" }), _jsx(Send, { size: 18, className: `relative z-10 transition-transform duration-700 ${input.trim() && !isVerifying ? 'translate-x-1 -translate-y-1 scale-110' : ''}`, strokeWidth: 1 }), input.trim() && !isVerifying && _jsx("div", { className: "absolute inset-0 bg-[#00f3ff]/[0.05] animate-pulse" })] })] })] }));
};
export default DiegeticTerminal;
